<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<VBox xmlns="http://javafx.com/javafx/17"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.meditriage.controller.HistoryController"
      spacing="20"
      style="-fx-padding: 28; -fx-background-color: #f0f2f5;">

    <!-- Encabezado -->
    <VBox spacing="4">
        <Label text="Historial de Atendidos" styleClass="page-title"/>
        <Label text="Pacientes atendidos â€” consulta BD con filtros combinados"
               styleClass="page-subtitle"/>
    </VBox>

    <!-- Panel de filtros -->
    <VBox styleClass="card" spacing="16">
        <Label text="Filtros" styleClass="section-title"/>
        <HBox spacing="16" alignment="CENTER_LEFT">
            <!-- Nivel -->
            <VBox spacing="4">
                <Label text="Nivel" styleClass="field-label"/>
                <ComboBox fx:id="cmbFilterLevel" prefWidth="200"/>
            </VBox>
            <!-- Nombre -->
            <VBox spacing="4">
                <Label text="Nombre contiene" styleClass="field-label"/>
                <TextField fx:id="txtFilterName"
                           promptText="Fragmento de nombre..."
                           prefWidth="200"
                           styleClass="text-field"/>
            </VBox>
            <!-- Tiempo -->
            <VBox spacing="4">
                <Label text="PerÃ­odo" styleClass="field-label"/>
                <ComboBox fx:id="cmbFilterTime" prefWidth="150"/>
            </VBox>

            <VBox spacing="4" alignment="BOTTOM_LEFT">
                <Label text=" "/><!-- spacer -->
                <HBox spacing="8">
                    <Button text="ðŸ” Filtrar"
                            styleClass="btn-primary"
                            onAction="#onApplyFilters"/>
                    <Button text="âœ• Limpiar"
                            styleClass="btn-secondary"
                            onAction="#onClearFilters"/>
                </HBox>
            </VBox>

            <Region HBox.hgrow="ALWAYS"/>
            <VBox spacing="4" alignment="BOTTOM_RIGHT">
                <Label text=" "/>
                <Button text="ðŸ“¤ Exportar CSV"
                        styleClass="btn-secondary"
                        onAction="#onExportCsv"/>
            </VBox>
        </HBox>
        <Label fx:id="lblHistoryInfo" text="â€”"
               style="-fx-text-fill: #636e72;"/>
    </VBox>

    <!-- Tabla de historial -->
    <TableView fx:id="tableHistory" VBox.vgrow="ALWAYS"
               style="-fx-background-color: white; -fx-background-radius: 12;
                      -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 10, 0, 0, 4);">
        <columns>
            <TableColumn fx:id="colId"       text="ID"        prefWidth="55"/>
            <TableColumn fx:id="colName"     text="Nombre"    prefWidth="155"/>
            <TableColumn fx:id="colAge"      text="Edad"      prefWidth="50"/>
            <TableColumn fx:id="colLevel"    text="Nivel"     prefWidth="160"/>
            <TableColumn fx:id="colSymptoms" text="SÃ­ntomas"  prefWidth="200"/>
            <TableColumn fx:id="colArrival"  text="Llegada"   prefWidth="110"/>
            <TableColumn fx:id="colAttended" text="Atendido"  prefWidth="110"/>
            <TableColumn fx:id="colWait"     text="Espera"    prefWidth="75"/>
        </columns>
        <columnResizePolicy>
            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
        </columnResizePolicy>
    </TableView>
</VBox>
